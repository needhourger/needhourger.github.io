<!doctype html><html lang=zh-cn>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content=" 概述    最近踩坑机器学习神经网络中的文本处理,所以有了这篇博客.记录一下基于python word2vec训练中文词向量的方法(英文也同样适用) 虽然事后我发现我需要的并不是词向量word2vec,而是训练获得句子向量的方法,权当做个预告吧(咕咕咕)
  词向量训练:在自然语言处理中将每个单词映射到一个空间向量过程,从而获得每个词汇之间的关联性.(可能说的不太对,大概就这样吧,不是理论帝)
   少数正经的图 
"><title>word2vec词向量训练</title><link rel=canonical href=https://blog.yuukisama.cc/p/word2vec%E8%AF%8D%E5%90%91%E9%87%8F%E8%AE%AD%E7%BB%83/>
<link rel=stylesheet href=/scss/style.min.css><meta property="og:title" content="word2vec词向量训练">
<meta property="og:description" content=" 概述    最近踩坑机器学习神经网络中的文本处理,所以有了这篇博客.记录一下基于python word2vec训练中文词向量的方法(英文也同样适用) 虽然事后我发现我需要的并不是词向量word2vec,而是训练获得句子向量的方法,权当做个预告吧(咕咕咕)
  词向量训练:在自然语言处理中将每个单词映射到一个空间向量过程,从而获得每个词汇之间的关联性.(可能说的不太对,大概就这样吧,不是理论帝)
   少数正经的图 
">
<meta property="og:url" content="https://blog.yuukisama.cc/p/word2vec%E8%AF%8D%E5%90%91%E9%87%8F%E8%AE%AD%E7%BB%83/">
<meta property="og:site_name" content="零碎记忆">
<meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="Python"><meta property="article:tag" content="机器学习"><meta property="article:published_time" content="2019-03-13T10:26:22+00:00"><meta property="article:modified_time" content="2019-03-13T10:26:22+00:00">
<meta name=twitter:site content="@Yukiricc">
<meta name=twitter:creator content="@Yukiricc"><meta name=twitter:title content="word2vec词向量训练">
<meta name=twitter:description content=" 概述    最近踩坑机器学习神经网络中的文本处理,所以有了这篇博客.记录一下基于python word2vec训练中文词向量的方法(英文也同样适用) 虽然事后我发现我需要的并不是词向量word2vec,而是训练获得句子向量的方法,权当做个预告吧(咕咕咕)
  词向量训练:在自然语言处理中将每个单词映射到一个空间向量过程,从而获得每个词汇之间的关联性.(可能说的不太对,大概就这样吧,不是理论帝)
   少数正经的图 
">
<link rel="shortcut icon" href=img/favicon.png>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YSMKSWDEQK"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-YSMKSWDEQK",{anonymize_ip:!1})}</script>
</head><body class="article-page has-toc">
<script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script>
<div class="container main-container flex
extended">
<div id=article-toolbar>
<a href=/ class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg>
<span>返回</span>
</a>
</div><main class="main full-width">
<article class=main-article>
<header class=article-header>
<div class=article-details>
<header class=article-category>
<a href=/categories/python/>
Python
</a>
<a href=/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/>
机器学习
</a>
</header><h2 class=article-title>
<a href=/p/word2vec%E8%AF%8D%E5%90%91%E9%87%8F%E8%AE%AD%E7%BB%83/>word2vec词向量训练</a>
</h2><footer class=article-time>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Mar 13, 2019</time>
</div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>
阅读时长: 1 分钟
</time>
</div></footer></div></header><section class=article-content>
<blockquote>
<h2 id=概述>概述</h2></blockquote><ul>
<li>
<p>最近踩坑机器学习神经网络中的文本处理,所以有了这篇博客.记录一下基于python word2vec训练中文词向量的方法(英文也同样适用)
<del>虽然事后我发现我需要的并不是词向量word2vec,而是训练获得句子向量的方法,权当做个预告吧(咕咕咕)</del></p></li><li>
<p>词向量训练:在自然语言处理中将每个单词映射到一个空间向量过程,从而获得每个词汇之间的关联性.(可能说的不太对,大概就这样吧,不是理论帝)</p></li></ul><p><figure class=gallery-image style=flex-grow:135;flex-basis:324px>
<a href=/p/word2vec%E8%AF%8D%E5%90%91%E9%87%8F%E8%AE%AD%E7%BB%83/0.jpg data-size=856x634>
<img src=/p/word2vec%E8%AF%8D%E5%90%91%E9%87%8F%E8%AE%AD%E7%BB%83/0.jpg width=856 height=634 srcset="/p/word2vec%E8%AF%8D%E5%90%91%E9%87%8F%E8%AE%AD%E7%BB%83/0_hu447f7c99fcc851c5ea0844fbe3107477_295506_480x0_resize_q75_box.jpg 480w, /p/word2vec%E8%AF%8D%E5%90%91%E9%87%8F%E8%AE%AD%E7%BB%83/0_hu447f7c99fcc851c5ea0844fbe3107477_295506_1024x0_resize_q75_box.jpg 1024w" loading=lazy alt=" 少数正经的图">
</a>
<figcaption>少数正经的图</figcaption></figure></p><h2 id=start>Start</h2><ul>
<li>python:3.5+</li></ul><ol>
<li>
<p>安装相应依赖</p><pre tabindex=0><code>pip install jieba 
pip install gensim
</code></pre><ul>
<li>jieba用于中文文本分词,英文可直接使用空格分割分词</li><li>gensim词向量训练模块</li></ul></li><li>
<p>数据预处理</p><pre tabindex=0><code>def load():
     with open(&#34;./train.tsv&#34;,&#34;r&#34;,encoding=&#34;utf-8&#34;) as f:
         lines=f.readlines()
         f.close()
         return lines
     return None
</code></pre><p>这里采用的数据格式是以&rsquo;\t&rsquo;分割的tsv文件,每一行包含一个句子以及其对应标签.这里将二者共同训练</p></li><li>
<p>分词并去除停止词</p><ul>
<li>停止词:指句子中的语气词,特殊符号,数字等对句子意义判别无帮助的词汇,这里推荐几个常用的中文停止词表,你也可以一句自己项目需要自己制作适合的停止词表<a class=link href=https://github.com/goto456/stopwords target=_blank rel=noopener>Github</a></li></ul><pre tabindex=0><code># 导入结巴分词
import jieba

# 读取停止词表函数,停止词表为一行一个的格式
def load_stopwords():
    with open(&#34;./stopwords.txt&#34;,&#34;r&#34;,encoding=&#34;utf-8&#34;) as f:
        words=f.readlines()
        f.close()
        return words
    return None

# 装载停止词表
stopowrds=load_stopwords()

# 分词去除停止词函数,lines为上一步中读取的单行数据,将所有的分词保存到文本文件中为下一步训练备用
def cut(lines):
    with open(&#34;cutwords.txt&#34;,&#34;w+&#34;,encoding=&#34;utf-8&#34;) as f:
        for line in lines:
            words=jieba.cut(line)

            #去除停止词
            for i in words:
            if i in stopwords:
                words.remove(i)

            f.write(&#34; &#34;.join(words))
            f.wirte(&#34;\n&#34;)
</code></pre></li><li>
<p>模型训练</p><pre tabindex=0><code># 导入词向量训练模块
from gensim.models import word2vec
from gensim.models.word2vec import LineSentence

# 训练函数
def model_train(
    sentence_in=sentence,   # 需要训练的数据
    size_in=300,                        # 生成的词向量维数,训练数据量越大,推荐数值越大
    window_in=5,                        # 滑动窗口大小,涉及到单个词语关联前后单词的数目
    min_count_in=2,                 # 字典截断,出现次数少于该数值的词汇会被放弃
    iter_in=5                               # 迭代次数
    ):

    print(&#34;start traing...&#34;)

    model=word2vec.Word2Vec(
    sentences=sentence_in,
    size=size_in,
    window=window_in,
    min_count=min_count_in,
    workers=multiprocessing.cpu_count(),
    iter=iter_in
    )

    print(&#34;traing complete...&#34;)
    return model

# 从之前完成分词的数据中装载训练数据,模型sentence参数可以是一个list
# 但是大批量数据时建议使用word2vec自带的类型导入
sentence=LineSentence(&#34;./cutwords.txt&#34;)
model=model_train(sentence,300,5,2,5)    
</code></pre></li><li>
<p>保存模型</p><pre tabindex=0><code># 参数为保存的文件名
model.save(&#34;modeltest&#34;)
</code></pre></li><li>
<p>模型的二次训练</p><pre tabindex=0><code># 读取模型
model = gensim.models.Word2Vec.load(&#39;modeltest&#39;)
# 追加训练
model.train(more_sentences)
</code></pre></li><li>
<p>模型使用</p><pre tabindex=0><code># 根据给定的词汇给出10个最相近的词汇
model.most_similar(&#34;男人&#34;)

# 找出离群词
model.doesnt_match(&#34;测试&#34;)

# 计算两个词汇相似度
model.similarity(&#39;男人&#39;, &#39;女人&#39;) 

# 获得单个词汇的词向量
model[&#39;男人&#39;]
</code></pre></li></ol></section><footer class=article-footer>
<section class=article-tags>
<a href=/tags/python/>Python</a>
<a href=/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/>机器学习</a>
</section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section></footer></article><aside class=related-contents--wrapper>
<h2 class=section-title>相关文章</h2><div class=related-contents>
<div class="flex article-list--tile">
<article>
<a href=/p/python-requests-ssl%E6%8A%A5%E9%94%99/>
<div class=article-details>
<h2 class=article-title>Python requests ssl报错</h2></div></a>
</article><article>
<a href=/p/%E9%AB%98%E9%98%B6%E7%88%AC%E8%99%ABselenium%E6%91%98%E8%AE%B0/>
<div class=article-details>
<h2 class=article-title>高阶爬虫selenium摘记</h2></div></a>
</article><article>
<a href=/p/python%E5%B8%B8%E7%94%A8skill/>
<div class=article-details>
<h2 class=article-title>Python常用Skill</h2></div></a>
</article></div></div></aside><footer class=site-footer>
<section class=copyright>
&copy;
2017 -
2022 零碎记忆
</section><section class=powerby>
Try to remember <br>
Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> <br>
Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.5.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>
</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div><div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main><aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div><h2 class="widget-title section-title">目录</h2><div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li><a href=#概述>概述</a></li><li><a href=#start>Start</a></li></ol></nav></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script>
</body></html>